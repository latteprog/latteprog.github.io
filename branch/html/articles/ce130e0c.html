<html>
	<head>
		<meta charset="UTF-8">

		<style>
			br
			{
				line-height: 340%;
			}

			div
			{
				line-height: 170%;
			}

			a
			{
				color: #C62818;
				text-decoration: none;
			}

			center
			{
				color: #C62818;
			}
		</style>

		<script type="text/javascript" src="/js/jquery.min.js"></script>

		<script type="text/javascript">
			function addPoints(c) {
				if(c == 0) {
					ctx.clearRect(0, 0, 300, 300);
					ctx.fillStyle = "#FFFFFF";
					ctx.fillRect(0, 0, 300, 300);
				}

				ctx.fillStyle = "#000000";
				ctx.fillRect(x[c] * 3, x[c + 1] * 3, 3, 3);

				setTimeout(function() { addPoints((c + 2) % 100); }, 200);
			}
		</script>
	</head>

	<body>
		<div style="font-family: CSChatThai; font-size: 28px; line-height: 150%; color: #C62818; float: left;"><b>Random Numbers</b>&#09;<font face="CSChatThai" size="4" color="#999999">-&#09;24.05.2016</font></div>
			
		<div style="font-family: CSChatThai; font-size: 18px; line-height: 170%; text-align: justify; color: #000000; clear: both;">ใครที่เคยเขียนโปรแกรมคงรู้ดีว่าคอมพิวเตอร์จะทำงานตามที่เราสั่งเป๊ะๆ ถ้าเรารันโปรแกรมเดิมซ้ำๆ ก็จะได้ผลลัพธ์เหมือนเดิมตลอด แต่เราก็รู้เช่นกันว่าคอมพิวเตอร์สามารถสุ่มเลขได้ สองประโยคนี้ดูจะขัดกันเพราะการสุ่มเลขควรจะเป็นสิ่งที่ทำหลายๆ ครั้งแล้วได้ผลไม่ซ้ำกัน และควรจะทำนายผลไม่ได้ ถ้าอย่างงั้นแล้วจริงๆ คอมพิวเตอร์สุ่มเลขได้ยังไงล่ะ?<br>ต่อจากประโยคเมื่อกี้นี้ก็น่าจะเดาได้ว่า จริงๆ แล้วมันก็สุ่มเลขไม่ได้หรอก แต่เราจะมีสิ่งที่เรียกว่า <a href='https://en.wikipedia.org/wiki/Pseudorandom_number_generator' target='_blank'>Pseudorandom Number Generator</a> ซึ่งคำนวณอะไรบางอย่างที่ทำให้ผลลัพธ์ที่ได้ดูเหมือนกับการสุ่ม เราจะมองว่าเลขที่เราจะสุ่มเป็นลำดับของเลข ซึ่งเราจะเรียกว่า <i>X<sub>n</sub></i> เป้าหมายของอัลกอรึทึมนี้ก็คือการคำนวณเลขตัวต่อไปในลำดับ ซึ่งคือ <i>X</i><sub><i>n</i>+1</sub> จากเลขตัวก่อนๆ หน้าในลำดับ และทำโดยให้ผลลัพธ์ดูเหมือนจะทำนายไม่ได้<br>อัลกอริทึมหนึ่งที่สามารถทำแบบนี้ได้คือ <a href='https://en.wikipedia.org/wiki/Linear_congruential_generator' target='_blank'>Linear congruential generator (LCG)</a> ในอัลกอริทึมนี้เราจะเริ่มโดยการเลือกเลข <i>X<sub>i</sub></i> แล้วคำนวณเลขตัวต่อๆ ไป ด้วยสูตร <i>X</i><sub><i>i</i> + 1</sub> = (<i>aX<sub>i</sub></i> + <i>c</i>) mod <i>m</i> โดย <i>a</i>, <i>c</i>, และ <i>m</i> เป็นค่าคงที่ที่ใช้ในการคำนวณ จะเห็นว่าผลลัพธ์จากการคำนวณนี้จะเป็นจำนวนเต็มที่มีค่าระหว่าง 0 ถึง <i>m</i> - 1 ฉะนั้นถ้าสมมติเราต้องการสุ่มเลขในช่วง 0 ถึง 99 เราก็เลือก <i>m</i> = 100 แล้วสมมติเราเลือก <i>a</i> = 61, <i>c</i> = 29, <i>X</i><sub>0</sub> = 42 จะได้ผลว่า
		<br><br style="line-height: 170%;"><table border="0" width="100%">
			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>0</sub>
				</td>
				<td width="50%">
					= 42
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>1</sub>
				</td>
				<td width="50%">
					= 91
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>2</sub>
				</td>
				<td width="50%">
					= 80
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>3</sub>
				</td>
				<td width="50%">
					= 9
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>4</sub>
				</td>
				<td width="50%">
					= 78
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>5</sub>
				</td>
				<td width="50%">
					= 87
				</td>
			</tr>
		</table><br style="line-height: 170%;">จะเห็นว่าผลที่ได้ดูเหมือนกับการสุ่มเลข แต่ถ้าลองเปลี่ยนค่าให้ <i>a</i> = 15, <i>c</i> = 37 จะได้ผลอีกแบบ
		<br><br style="line-height: 170%;"><table border="0" width="100%">
			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>0</sub>
				</td>
				<td wikipediath="50%">
					= 42
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>1</sub>
				</td>
				<td width="50%">
					= 67
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>2</sub>
				</td>
				<td width="50%">
					= 42
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>3</sub>
				</td>
				<td width="50%">
					= 67
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>4</sub>
				</td>
				<td width="50%">
					= 42
				</td>
			</tr>

			<tr>
				<td width="50%" align="right">
					<i>X</i><sub>5</sub>
				</td>
				<td width="50%">
					= 67
				</td>
			</tr>
		</table><br style="line-height: 170%;">คราวนี้จะเห็นว่าผลลัพธ์แค่สลับอยู่ระหว่างเลขสองตัว ซึ่งเราไม่มองว่ามันเป็นการสุ่ม เพราะมันมีรูปแบบที่ชัดเจนมาก แล้วถ้าอย่างงั้นแล้วเราจะรู้ได้ยังไงล่ะ ว่าควรจะเลือกค่าพวกนี้ยังไง<br>ในอัลกอริทึมประเภทนี้จะมีค่าค่าหนึ่งที่เราเรียกว่า "คาบ" (ทุกอัลกอริทึมการสุ่มมีสมบัตินี้ พิสูจน์ได้ด้วยหลักรังนกพิราบ) ซึ่งบอกว่าหลังจากผ่านเลขไปกี่ตัวแล้ว ลำดับจะวนกลับมาซ้ำเดิม อย่างเช่นในตัวอย่างที่สอง ที่เราลองคำนวณออกมาด้านบนมีคาบเท่ากับ 2 เพราะลำดับจะกลับมาซ้ำเดิมหลังเลขทุกๆ 2 ตัว ตามความรุ้สึกเราแล้วก็จะมองว่าอัลกอริทึมสุ่มที่ดีเป็นอัลกอริทึมที่มีคาบยาวๆ เราจึงใช้คาบเป็นมาตรวัดหนึ่งที่ใช้ดูว่าอัลกอริทึมหนึ่งดีแค่ไหน<br>คราวนี้ถ้าเราลองนำค่าที่เราสุ่มมาในตารางแรกมาพล็อตจุดบนระนาบ โดยนำเลขสองตัวที่อยู่ติดกันมาต่อกันเป็นคู่อันดับ เช่นจุดแรกที่จะพล็อตก็จะเป็น (42, 91) และจุดต่อมาก็คือ (80, 9) ไปเรื่อยๆ จนครบ 50 จุด (ในตัวอย่างแรกคาบมีค่าเท่ากับ 100 ฉะนั้นทุกๆ 50 จุด ข้อมูลก็จะกลับมาเหมือนเดิม) ลองมาดูจุดทั้งหมดที่ได้กัน<br>
		<center><canvas id="canvas1" height="300px" width="300px"></canvas><br>จุดแต่ละจุดคือคู่อันดับที่ได้จากการสุ่มด้วย LCG<br></center>เราจะเห็นรูปแบบของจุดที่ถูกพล็อตได้อย่างชัดเจน การทดสอบนี้เรียกว่า Spectral test และในกรณีนี้คือการทดสอบบนสองมิติ จากการพล็อตนี้ก็จะได้ผลว่า LCG ด้วยค่าคงที่ตามตัวอย่างแรกไม่ผ่านการทดสอบนี้ การที่จุดอยู่ในรูปแบบนี้ทำให้เราทำนายเลขตัวต่อๆ ไปจากการสุ่มได้ง่ายขึ้น ซึ่งขัดกับจุดประสงค์ของเรา การทดสอบนี้จึงเป็นมาตรวัดอีกตัวหนึ่งที่ใช้ได้<br>ในโพสนี้เราก็ได้พูดถึงวิธีสุ่มเลขในคอมพิวเตอร์และวิธีตรวจสอบบางวิธี สรุปว่าจริงๆ แล้วคอมพิวเตอร์ก็สุ่มเลขไม่ได้ เพียงแค่จำลองเหมือนกับว่าเลขเหล่านี้ถูกสุ่มมา อัลกอริทึมที่เรายกตัวอย่างมาที่ดูเหมือนจะใช้ได้ดีก็ถูกล้มด้วยการทดสอบหนึ่ง อัลกอริทึมการสุ่มที่นิยมใช้อยู่ในปัจจุบันอัลกอริทึมหนึ่งคือ <a href='https://en.wikipedia.org/wiki/Mersenne_Twister' target='_blank'>Mersenne Twister</a> ซึ่งค่อนข้างซับซ้อน (ผมเพิ่งเปิดอ่านและก็ยังอ่านไม่เข้าใจ แหะๆ) จึงขอไม่กล่าวถึงในโพสนี้ แต่ถ้าใครสนใจก็ลองเปิดอ่านดูได้ครับ ส่วนผมก็ขอจบโพสนี้แค่นี้ แล้วเจอกันโพสหน้าครับ<br>
		</div>

		<script type="text/javascript">
			$(function() {
				window.canvas = document.getElementById("canvas1");
				window.ctx = canvas.getContext("2d");

				window.x = [];
				var a = 61;
				var c = 29;

				window.x[0] = 42;

				for(var i = 1; i < 100; i++)
				{
					window.x[i] = (window.x[i - 1] * a + c) % 100;
				}

				addPoints(0);
			});
		</script>
	</body>
</html>